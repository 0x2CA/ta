 # Unity引擎渲染流水线

![GPUæµæ°´çº¿.png-82.2kB](https://img-blog.csdnimg.cn/img_convert/2bc6644b345b29af4636d0f78116a275.png)

- 颜色表示了不同阶段的可控性级别（从高到底）：
  - 绿色：该流水线阶段是完全可编程控制的
    - 实线：该Shader必须由开发者编程实现
    - 虚线：该Shader是可选的
  - 黄色：该流水线阶段可以配置但不是可编程的
  - 蓝色：该流水线阶段是由GPU固定实现的，开发者没有任何控制权

- 顶点数据：将顶点数据按语义输入渲染管线

- 几何阶段
  - 顶点着色器：执行顶点的顶点变换、光照计算、贴图映射坐标计算
  - 曲面细分着色器【可选】：图元细分
  - 几何体着色器【可选】：执行逐片元着色
  - 裁剪【可配置】：剔除不可见三角形
  - 屏幕映射【不可编程，不可配置】：将图元从投影空间转换到屏幕空间
- 光栅化阶段：
  - 三角形设置【不可编程，不可配置】：得到三角形内可渲染像素的起点和终点（扫描线）
  - 三角形遍历【不可编程，不可配置】：根据扫描线生成片元
  - 片元着色器：控制每个像素的着色
  - 逐片元操作【可配置】：
    - [模版测试](02-模版测试.md)
    - [深度测试](03-深度测试.md)
    - Alpha测试
    - [Alpha混合](04-Alpha混合.md)
  - 注意：Eealy-Z技术会导致深度测试提前，造成Alpha测试和混合结果混乱，以及Early-Z优化失败，从而不可避免的产生片元着色开销
  - 采用Early-Z技术的Unity引擎渲染流程如下：
     ![img](%E6%B8%B2%E6%9F%93%E6%B5%81%E6%B0%B4%E7%BA%BF.assets/PipelineCullDepth.png) 

